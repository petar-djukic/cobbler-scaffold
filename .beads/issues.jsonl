{"id":"cobbler-6e3","title":"GH-25: bd ready returns empty after stitch timeout (stale task state)","description":"After a stitch timeout (the Claude process is killed at max_time_sec), the beads task enters a state where bd ready cannot find it, even though bd show \u003cid\u003e shows it as READY. This requires manual intervention to re-queue the task.\n\nRoot cause: resetTask(), recoverStaleBranches(), and resetOrphanedIssues() call bdUpdateStatus(id, \"ready\") but \"ready\" is not a valid beads status. The bd CLI silently accepts it, but bd ready only returns issues with status \"open\". The task becomes invisible.\n\nFix: Change \"ready\" to \"open\" in all three locations, add error handling, and add tests.\n\nGitHub: petar-djukic/cobbler-scaffold#25","status":"open","priority":2,"issue_type":"epic","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T01:17:55Z","created_by":"petardjukic","updated_at":"2026-02-26T01:17:55Z"}
{"id":"cobbler-6e3.2","title":"Fix status value and add error handling in task reset paths","description":"## Required Reading\n- pkg/orchestrator/stitch.go (resetTask, recoverStaleBranches, resetOrphanedIssues)\n- pkg/orchestrator/commands.go (bdUpdateStatus)\n\n## Files to Modify\n- pkg/orchestrator/stitch.go\n\n## Requirements\n1. Replace \"ready\" with \"open\" in all 3 bdUpdateStatus calls:\n   - Line 729: resetTask()\n   - Line 225: recoverStaleBranches()\n   - Line 261: resetOrphanedIssues()\n2. Add error checking in resetTask() — currently ignores return from bdUpdateStatus\n3. Add a constant (statusOpen = \"open\") to avoid repeated string literals\n4. Update the comment on line 22 that mentions \"ready\"\n\n## Design Decisions\n- Use a package-level constant for status strings to prevent future typos\n- Log warnings on bdUpdateStatus failure (don't fail hard — cleanup should continue)\n\n## Acceptance Criteria\n- All task reset paths use \"open\" status\n- resetTask logs warning if bdUpdateStatus fails\n- No string literal \"ready\" used as a beads status value\n- Code compiles: go build ./...","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T01:18:10Z","created_by":"petardjukic","updated_at":"2026-02-26T01:24:37Z","closed_at":"2026-02-26T01:24:37Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-6e3.2","depends_on_id":"cobbler-6e3","type":"parent-child","created_at":"2026-02-25T20:18:10Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":1,"issue_id":"cobbler-6e3.2","author":"petardjukic","text":"tokens: 0","created_at":"2026-02-26T01:24:37Z"}]}
{"id":"cobbler-6e3.3","title":"Add tests for stitch timeout recovery","description":"## Required Reading\n- pkg/orchestrator/stitch.go (resetTask, resetOrphanedIssues, recoverStaleTasks)\n- tests/rel01.0/internal/testutil/testutil.go (CountReadyIssues, CreateIssue helpers)\n- Existing *_test.go files in pkg/orchestrator/\n\n## Files to Create/Modify\n- pkg/orchestrator/stitch_test.go (new or existing)\n\n## Requirements\n1. Test that resetTask sets status to \"open\" (verifiable via bd ready)\n2. Test that resetOrphanedIssues resets orphaned tasks to \"open\"\n3. Test that after reset, bd ready returns the task\n4. Test error case: verify logging when bdUpdateStatus fails\n\n## Design Decisions\n- Use bd CLI in tests (integration-style) since the code under test calls bd as external process\n- May need test helpers to initialize and tear down beads state\n\n## Acceptance Criteria\n- Tests pass: go test ./pkg/orchestrator/...\n- Tests cover the timeout → reset → bd ready cycle\n- No flaky tests (deterministic state setup/teardown)","status":"closed","priority":2,"issue_type":"task","owner":"petar.djukic@gmail.com","created_at":"2026-02-26T01:18:18Z","created_by":"petardjukic","updated_at":"2026-02-26T01:33:04Z","closed_at":"2026-02-26T01:33:04Z","close_reason":"Closed","dependencies":[{"issue_id":"cobbler-6e3.3","depends_on_id":"cobbler-6e3","type":"parent-child","created_at":"2026-02-25T20:18:17Z","created_by":"petardjukic","metadata":"{}"}],"comments":[{"id":2,"issue_id":"cobbler-6e3.3","author":"petardjukic","text":"tokens: 0","created_at":"2026-02-26T01:33:03Z"}]}
